<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
   
<mapper namespace="com.webank.working.web.dao.ProductDao">

	<resultMap type="com.webank.working.web.dto.Product" id="Product">    
	    <id column="ID" property="id"/>    
	    <result column="NAME" property="name"/>    
	    <result column="DESCRIPTION" property="description"/>    
	    <result column="QUANTITY" property="quantity"/>    
	</resultMap>
	
	<sql id="Base_Column_List">
         ID, NAME, DESCRIPTION, QUANTITY
  	</sql>

    <insert id="insert" parameterType="Product" useGeneratedKeys="true" keyProperty="id">  
       insert into product (NAME, DESCRIPTION, QUANTITY) values(#{name}, #{description}, #{quantity})  
    </insert>  
     
    <select id="getProductById" parameterType="int" resultType="Product">  
       select 
       <include refid="Base_Column_List"/>
       from product where ID = #{id}
    </select>
    
    <update id="updateByPrimaryKeySelective" parameterType="com.webank.working.web.dto.Product" >
    update product
    <set >
      <if test="name != null" >
        NAME = #{name,jdbcType=VARCHAR},
      </if>
      <if test="description != null" >
        DESCRIPTION = #{description,jdbcType=VARCHAR},
      </if>
      <if test="quantity != null" >
        QUANTITY = #{quantity,jdbcType=INTEGER},
      </if>
    </set>
    where ID = #{id,jdbcType=INTEGER}
  </update>
  
  	<select id="lockProduct" parameterType="int" resultType="Product">  
       select 
       <include refid="Base_Column_List"/>
       from product where ID = #{id} for update
    </select>
</mapper>  